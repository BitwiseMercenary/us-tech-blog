<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0"><meta name="author" content="OpenTable"><link rel="icon" href="/favicon.png"><title>OpenTable Tech UK Blog</title><meta name="description"><link rel="alternate" type="application/rss+xml" title="OpenTable Tech UK Blog" href="/atom.xml"><link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css"><link rel="stylesheet" href="/css/bootstrap.min.css"><link rel="stylesheet" href="/css/main.css"><script src="//fonts.otstatic.com/zys4lfz.js"></script><link rel="stylesheet" href="/css/highlight.css">
</head><body><nav class="navbar navbar-default navbar-fixed-top navbar-custom"><div class="container-fluid"><div class="navbar-header"><button type="button" data-toggle="collapse" data-target="#main-navbar" class="navbar-toggle"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><a href="/" class="navbar-brand">OpenTable Tech UK Blog</a></div><div id="main-navbar" class="collapse navbar-collapse"><ul class="nav navbar-nav navbar-right"><li><a href="/about/">About</a></li><li><a href="/archives/">Archive</a></li><li><a href="/blog/authors/">Authors</a></li></ul></div><div class="avatar-container"><div class="avatar-img-border"><a href="/"><img src="/opentable.png" class="avatar-img"></a></div></div></div></nav><div id="header-big-imgs" data-num-img='3' data-img-src-1="/bigimgs/building.jpg" data-img-desc-1="Alphabeta Building" data-img-src-2="/bigimgs/kitchen.jpg" data-img-desc-2="OpenTable London office" data-img-src-3="/bigimgs/office.jpg" data-img-desc-3="OpenTable Engineers"></div><header class="header-section has-img"><div class="intro-header big-img"><div class="container"><div class="row"><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><div class="page-heading"><h1>OpenTable Tech UK Blog</h1><hr class="small"><span class="page-subheading">The technology blog for OpenTable UK.</span></div></div></div></div><span class="img-desc"></span></div></header><div role="main" class="container"><div class="row"><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><div class="posts-list"><article class="post-preview"><a href="/blog/2014/09/04/introducing-hobknob-feature-toggling-with-etcd/"><h2 class="post-title">Introducing Hobknob: Feature toggling with etcd</h2></a><p class="post-meta">Posted on 4 September 2014 · <a href="/blog/categories/Hobknob/" class="tag post-meta">Hobknob</a></p><div class="post-entry"><p>The ability to dynamically turn features on/off in software without the need to redeploy code is extremely beneficial. Whether you are trialing a new feature or using branch by abstraction to avoid creating feature branches, the use of feature toggles can aid continuous delivery and provide a mechanism to reduce mean time to resolution when an issue occurs.</p>
<p>With a relatively large engineering department with multiple teams spread across the US and UK the need to manage feature toggles has evolved to the point whereby individual teams have developed their own implementations. Most of these are simple config files.</p>
<p>We decided to unify this effort by providing a central place to store feature toggles, provide a dashboard to be able to turn these toggles on/off and provide language specific clients to integrate into our software components.</p>
<p>The results of this was <a href="https://github.com/opentable/hobknob" target="_blank" rel="external">Hobknob</a>.</p>
<h2 id="Why-etcd"><a href="#Why-etcd" class="headerlink" title="Why etcd?"></a>Why etcd?</h2><p>We made the decision to use <a href="https://github.com/coreos/etcd" target="_blank" rel="external">etcd</a>. Etcd is “a highly-available key value store for shared configuration” (<a href="https://github.com/coreos/etcd#etcd" target="_blank" rel="external">https://github.com/coreos/etcd#etcd</a>). It provides a HTTP API to store and retrieve data. This is what makes it perfect for a feature toggling solution used by multiple components. It means that we didn’t have to write an intermediate API on top of a data store for consumers.</p>
<p>So, for example, to store a feature toggle in etcd:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">curl -L http://127.0.0.1:4001/v2/keys/v1/toggles/restaurant-api/testtoggle -XPUT -d value=&quot;true&quot;</div></pre></td></tr></table></figure>
<p>To retrieve a feature toggle:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">curl -L http://127.0.0.1:4001/v2/keys/v1/toggles/restaurant-api/testtoggle</div></pre></td></tr></table></figure></div><a href="/blog/2014/09/04/introducing-hobknob-feature-toggling-with-etcd/" class="post-read-more">[Read More]</a></article><article class="post-preview"><a href="/blog/2014/09/01/testing-puppet-with-beaker-pt-dot-3-testing-roles/"><h2 class="post-title">Testing Puppet with Beaker pt.3 - Testing Roles</h2></a><p class="post-meta">Posted on 1 September 2014</p><div class="post-entry"><p>In the first two parts of this blog series we have focusing on testing puppet <em>modules</em> with beaker. As an open source contributor there is always<br>a large test matrix so this makes absolute sense. But what about the other large use-case for beaker - what about our day-to-day internal code base?<br>Not all of this is modules, in fact a large portion of it is other puppet code - roles, profiles, facts, hiera data etc. All of this needs testing<br>as well.</p>
<p>In this blog post I will be showing how we have started using beaker to test our puppet roles and profiles for both Linux and Windows.</p>
<h2 id="Master-vs-Masterless"><a href="#Master-vs-Masterless" class="headerlink" title="Master-vs-Masterless"></a>Master-vs-Masterless</h2><p>Prior to this post all our beaker testing has been master-less i.e. using using puppet agent apply. This is perfectly adequate for most use cases when<br>testing modules in isolation but doesn’t always work when testing an internal code base (unless you are masterless there as well then please skip to the next section).</p>
<p>At OpenTable we do use a central puppet master to compile our catalogs. So when testing our puppet roles we wanted to make sure that we were also testing<br>with a master-agent configuration. It is worth mentioning here that if (like us) you are testing windows agents then you are going to need to test with master-agent<br>approach due to the lack of a windows master.</p>
<p>Testing the master-agent configuration means configuring multi-node sets in beaker. There are not many examples of this but the principle is very much<br>the same as the single-node nodeset. Here is an example:</p>
<pre><code>HOSTS:
  ubuntu-server-12042-x64-master:
    roles:
      - master
    platform: ubuntu-12.04-amd64
    box: ubuntu-server-12042-x64-vbox4210-nocm
    box_url: http://puppet-vagrant-boxes.puppetlabs.com/ubuntu-server-12042-x64-vbox4210-nocm.box
    hypervisor: vagrant
    ip: &apos;10.255.33.135&apos;
  win-2008R2-std:
    roles:
      - default
      - agent
    platform: windows-server-amd64
    box: opentable/win-2008r2-standard-amd64-nocm
    box_version: = 1.0.0
    box_check_update: false
    hypervisor: vagrant
    user: vagrant
    ip: &apos;10.255.33.129&apos;
    communicator: bitvise
CONFIG:
  log_level: verbose
  type: git
</code></pre><p>In this example you will see that we are specifying different ‘roles’ for each host in the nodeset. What a role is in in this context is a tag for that node that allows<br>us to reference it directly later when running commands on the host. To avoid any further confusion, from this point onwards if I am referring to the role defined in the<br>nodeset file I will call it the ‘nodeset role’ otherwise I am referring the the puppet role provided in the manifest. There are a couple of build-in nodeset roles that<br>Beaker already knows about: master, agent and default. The first two are pretty self explanatory but the last nodeset role - default - is the location where the tests<br>themselves run. In you don’t specify the ‘default’ nodeset role on any of your host definitions then the tests will run on the first host that you specified in in the<br>nodeset file (which in the case of the example above would be wrong).</p>
<p>You may have a more complicated configuration that you wish to test and this allows you to specify arbitrary tags which can be very useful.</p>
<p>We can now use these nodeset roles to configure our master and agent.</p></div><a href="/blog/2014/09/01/testing-puppet-with-beaker-pt-dot-3-testing-roles/" class="post-read-more">[Read More]</a></article><article class="post-preview"><a href="/blog/2014/09/01/testing-puppet-with-beaker-pt-dot-2-the-windows-story/"><h2 class="post-title">Testing Puppet with Beaker pt.2 - The Windows story</h2></a><p class="post-meta">Posted on 1 September 2014 · <a href="/blog/categories/Acceptance-tests/" class="tag post-meta">Acceptance tests</a> · <a href="/blog/categories/Puppet/" class="tag post-meta">Puppet</a> · <a href="/blog/categories/Vagrant/" class="tag post-meta">Vagrant</a> · <a href="/blog/categories/Windows/" class="tag post-meta">Windows</a> · <a href="/blog/categories/Beaker/" class="tag post-meta">Beaker</a></p><div class="post-entry"><p>In <a href="/blog/2014/04/04/testing-puppet-with-beaker/">part one</a> we discussed our first steps into the world of acceptance testing our Puppet manifests.<br>By using Beaker we able to test managing local users on our Linux boxes. This was a positive experience for us. It allowed us to get to grips with the basics of configuring<br>Beaker to run tests and configuring our node sets to run those tests against. In this post, we will be discussing how we went about getting Beaker working with Windows.</p>
<p>As many of your reading this will be aware, OpenTable currently has quite a large Windows infrastructure and we are using Puppet extensively to maintain that environment.<br>We are also moving forward with releasing as many of our modules open source onto the <a href="https://forge.puppetlabs.com/opentable" target="_blank" rel="external">Puppet Forge</a> as possible (11 out of 18 of which are Windows<br>exclusive). What this means is that there was no way that we could ignore trying to use Beaker to test our manifests against Windows. We knew that we would have to support<br>many different versions and editions of Windows out there in the community as well that the ones we have to support internally.</p>
<p>This was going to be a challenge (configuration management with Windows usually is) but we were up for it.</p>
<p>##The Preliminaries</p>
<p>###Serverspec<br>The first step was looking at Serverspec. Serverspec is a Ruby gem that provides extensions to RSpec that allow you to test the actual state of your servers, either locally<br>or from the outside in via SSH. What we needed to know was did it support Windows? The answer was thankfully a resounding “Yes!”. All the <a href="http://serverspec.org/resource_types.html" target="_blank" rel="external">resource types</a> that you might want to test including file, service and user are available and supported on Windows. There are also a couple of Windows specific ones such as iis_website, Windows_feature and Windows_registry_key. We even added our own to support <a href="https://github.com/serverspec/serverspec/pull/403/files" target="_blank" rel="external">Windows_scheduled_task</a>. Interestingly Serverspec also supports WinRM as an alternative to SSH when you are testing from the outside-in but we will go back into that later. As long as your using Serverspec &gt; 1.6 you will have all the Windows support you might need.</p>
<p>###Packer<br>Step two was to build some Windows Vagrant boxes to test against. The documentation on the <a href="http://github.com/puppetlabs/beaker/wiki" target="_blank" rel="external">wiki</a> was (at the time) a bit slim when it came<br>to building test boxes but we knew we needed Cygwin so we went ahead and created the boxes that we needed. All our boxes are created with Packer <a href="http://github.com/opentable/packer-images" target="_blank" rel="external">and are open sourced on GitHub</a>. They have also been <a href="http://vagrantcloud.com/opentable" target="_blank" rel="external">published to Vagrant Cloud</a><br>so you can download pre-built images and get up and running quickly (version 1.x images contain the Cygwin installation).</p>
<p>###Beaker<br>So far, so good. We hit a couple of issues in our initial test runs with Beaker: missing module_path, installation using the msi and 32-bit Windows support - but these were very<br>small issues and we were happy to be able to contribute back some changes (<a href="https://github.com/puppetlabs/beaker/pull/234" target="_blank" rel="external">234</a>,<br><a href="https://github.com/puppetlabs/beaker/pull/235" target="_blank" rel="external">235</a>, <a href="https://github.com/puppetlabs/beaker/pull/236" target="_blank" rel="external">236</a>). We were very happy and managed to get out first module tested,<br>the <a href="http://github.com/opentable/puppet-puppetversion/" target="_blank" rel="external">cross-platform module puppet-puppetversion</a> for doing Puppet upgrades.</p>
<p>##The First Example<br>Let’s take a more detailed look at those puppetversion tests, how we configured Beaker to run and how it changed for the Windows support. I am going to assume at this point that<br>you already have some familiarity with Beaker; if not and this is your first steps into the testing tool then I would suggest going back and read <a href="/blog/2014/04/04/testing-puppet-with-beaker/">part one</a> of this series which contains a little bit of background to this and some useful resources for getting started.</p>
<p>The first thing that we needed to change for Windows was our <a href="https://raw.githubusercontent.com/opentable/puppet-puppetversion/master/spec/spec_helper_acceptance.rb" target="_blank" rel="external">spec_accepentance.rb file</a>.</p>
<p>Step one was to include the appropriate Serverspec helpers. What this does is let Serverspec know that we are executing on Windows so that underlying resources work correctly. We are also telling<br>server spec here to communicate using WinRM.</p></div><a href="/blog/2014/09/01/testing-puppet-with-beaker-pt-dot-2-the-windows-story/" class="post-read-more">[Read More]</a></article><article class="post-preview"><a href="/blog/2014/08/08/what-can-i-do/"><h2 class="post-title">What can I do?</h2></a><p class="post-meta">Posted on 8 August 2014 · <a href="/blog/categories/Leadership/" class="tag post-meta">Leadership</a> · <a href="/blog/categories/Coaching/" class="tag post-meta">Coaching</a> · <a href="/blog/categories/Work-smarter/" class="tag post-meta">Work smarter</a> · <a href="/blog/categories/Culture/" class="tag post-meta">Culture</a></p><div class="post-entry"><p>I’ve noticed recently a lot of content in my social media network is based on the current escalating problems in the Middle East.</p>
<p>Whenever I see such content from a friend or follower, I’m reminded of Stephen Covey’s <a href="http://www.amazon.co.uk/gp/product/B00GOZV3TM/ref=as_li_tl?ie=UTF8&amp;camp=1634&amp;creative=19450&amp;creativeASIN=B00GOZV3TM&amp;linkCode=as2&amp;tag=helenpieli-21&amp;linkId=RTIUTRBYIE6APBJA" target="_blank" rel="external">The 7 Habits of Highly Effective People</a> - Circle of Influence, Circle of Concern.</p>
<p>Covey says that in order to remain truly effective, we should focus our time and energy on situations we can influence. Don’t worry about things we cannot control, such as the weather, the economy or indeed foreign conflicts. </p>
<p>Covey’s work implies that if we identify the areas that are inside our Circle of Influence we will be more productive and make more of an impact;</p>
<p><img src="http://www.chowamigo.co.uk/images/what_can_i_do.png" alt="image"></p>
<p>If I’m honest I find this work quite harsh in its approach. Indeed it might not sit well with everyone. However, I personally found myself much less burdened once I could identify which problems I had control over. </p>
<h2 id="Expand-your-influence"><a href="#Expand-your-influence" class="headerlink" title="Expand your influence"></a>Expand your influence</h2><p>I still find myself watching the news, reading press reports and shaking my head at the global problems we’ve yet to solve. Covey’s stance is a tough one to take - don’t waste energy on X, your time and resources are better utilised by focusing on what you can change. </p>
<p>Some examples:</p>
<ul>
<li><p>I’m concerned about global warming =&gt; recycle waste as best you can, be energy efficient with your devices, insulate your home more effectively.</p>
</li>
<li><p>I’m concerned about my finances =&gt; learn new skills, look for a better role, try to control your spending, reduce unnecessary outgoings.</p>
</li>
<li><p>I’m concerned about my health =&gt; get a check up, start to eat healthily, take regular exercise, reduce tobacco and alcohol intake.</p>
</li>
</ul></div><a href="/blog/2014/08/08/what-can-i-do/" class="post-read-more">[Read More]</a></article><article class="post-preview"><a href="/blog/2014/05/20/acceptance-now/"><h2 class="post-title">Acceptance Now</h2></a><p class="post-meta">Posted on 20 May 2014 · <a href="/blog/categories/Engineering/" class="tag post-meta">Engineering</a> · <a href="/blog/categories/Testing/" class="tag post-meta">Testing</a> · <a href="/blog/categories/Acceptance-tests/" class="tag post-meta">Acceptance tests</a> · <a href="/blog/categories/Innovation/" class="tag post-meta">Innovation</a></p><div class="post-entry"><p><em>When is acceptance-only testing a good idea, and how can its problems be overcome?</em></p>
<p>In <a href="/blog/2014/04/16/look-ma-no-unit-tests">a recent post</a>, I espoused some of the benefits my team enjoyed by reducing our test-base to a single layer of acceptance tests, with no separate unit or integration tests. It caused <a href="http://www.reddit.com/r/programming/comments/237fr1/look_ma_no_unit_tests/" target="_blank" rel="external">some minor controversy</a>, which was not to be unexpected. At the time, I knew I had left out some details for brevity’s sake. In this post—spurred on by some interesting <a href="https://twitter.com/NathanGloyn/status/456756552092098561" target="_blank" rel="external">questions</a> and <a href="http://www.reddit.com/r/programming/comments/237fr1/look_ma_no_unit_tests/cgujuv7" target="_blank" rel="external">commentary</a>—I’d like to offer a more constructive view on the subject, and dig a little deeper into the nitty gritty of how we made it work.</p>
<p>I’ll also point out some other hidden benefits of moving to acceptance-only testing, and suggest synergistic practices that can help decide if this is the right approach for your project.</p>
<h2 id="Seams"><a href="#Seams" class="headerlink" title="Seams"></a>Seams</h2><p>After-the-fact unit testing requires us to <a href="https://www.youtube.com/watch?v=wEhu57pih5w" target="_blank" rel="external">find the seams</a> along which code can be isolated and tested. Where those seams don’t exist,  the temptation is to refactor code until they do, using patterns like <a href="http://martinfowler.com/articles/injection.html" target="_blank" rel="external">dependency injection</a>, and following <a href="http://en.wikipedia.org/wiki/Single_responsibility_principle" target="_blank" rel="external">SRP</a> and other <a href="http://butunclebob.com/ArticleS.UncleBob.PrinciplesOfOod" target="_blank" rel="external">SOLID</a> patterns.</p>
<p><a href="http://en.wikipedia.org/wiki/Test-driven_development" target="_blank" rel="external">Test-first unit testing</a> aka TDD naturally tends to maximise seams, and results in highly decoupled code with small, specific tests. TDD must result in 100% unit test coverage, if practiced according to <a href="http://en.wikipedia.org/wiki/Test-Driven_Development_by_Example" target="_blank" rel="external">the gospel</a>. In other words, TDD results in the best kind of code for later <a href="http://sourcemaking.com/refactoring" target="_blank" rel="external">modification without risk</a>, and the best tests for detailed, granular feedback. Unit tests also tend to run very quickly, sometimes fast enough to <a href="http://misko.hevery.com/2009/05/07/configure-your-ide-to-run-your-tests-automatically/" target="_blank" rel="external">run every time you hit “Save”</a>.</p>
<p><strong>Acceptance testing has far fewer seams available.</strong> Typically only one: the application boundary. Yes: <em>Your tests must invoke the entire application each time they are run.</em> Thus running acceptance tests is potentially very slow for even moderately sized projects with few dependencies—let alone large ones with many. Another problem is that, when an acceptance test fails, the failure could be at <em>any</em> layer in the stack. You immediately lose the pinpoint specificity afforded by unit tests.</p>
<p>Why, then, is it sometimes a good idea to forgo unit- in favour of acceptance-tests?</p>
<p>As we will see, the first issue, performance, can be mitigated. The second, granularity, is more difficult to overcome. But sometimes <em>that might be okay.</em></p>
<h2 id="Performance"><a href="#Performance" class="headerlink" title="Performance"></a>Performance</h2></div><a href="/blog/2014/05/20/acceptance-now/" class="post-read-more">[Read More]</a></article><article class="post-preview"><a href="/blog/2014/05/19/continuous-delivery-automating-deployment-visibility/"><h2 class="post-title">Continuous Delivery: Automating Deployment Visibility</h2></a><p class="post-meta">Posted on 19 May 2014 · <a href="/blog/categories/Continuous-delivery/" class="tag post-meta">Continuous delivery</a> · <a href="/blog/categories/Hubot/" class="tag post-meta">Hubot</a> · <a href="/blog/categories/Hipchat/" class="tag post-meta">Hipchat</a> · <a href="/blog/categories/Chatops/" class="tag post-meta">Chatops</a></p><div class="post-entry"><p>In our continued effort to drive towards a service oriented architecture each of our teams are continuously improving their deployment processes. Recently our team has focussed on automating as much as possible, putting as much into chat as we can and improving our logging/metrics.</p>
<p>The image below shows at a high level what our teams current deployment pipeline looks like and this post will attempt to summarise some recent changes that have allowed us to automate visibility.</p>
<img src="/images/posts/release-pipeline.png" width="900" height="350" title="image images">
<p>##Kicking off a deployment</p>
<p>I wrote previously that we started <a href="/blog/2013/11/22/beginning-a-journey-to-chatops-with-hubot/">using chatops</a> to increase visibility operationally. Hubot is central to this and we wrote a small script to kick off deployments within <a href="https://www.hipchat.com/" target="_blank" rel="external">Hipchat</a></p>
<img src="/images/posts/hubot-deploy-restaurant.png" width="350" height="350" title="image images">
<p>We have two TeamCity instances. The first is used as a build and deployment system to our pre-production servers. The second is used as a deployment system to our production servers. Artifacts from our non-production instance are stored in <a href="http://www.jfrog.com/home/v_artifactory_opensource_overview" target="_blank" rel="external">Artifactory</a> and our production deployment makes an API call to non-production TeamCity to ask for the last successfully pinned build. Pinning a build only occurs when we’re happy that the build is ready to be shipped (passing unit and acceptance tests). The above Hubot command will pin the non-production build, given that the build succeeded, and add a build to the queue in production. </p>
<p>To configure Hubot to do this we wrote a command to setup aliases providing the build id of the build to pin (non-production) and the build id of the build to kick off (production).</p>
<img src="/images/posts/hubot-deploy-alias.png" width="350" height="350" title="image images">
<p>##Deployment visibility</p></div><a href="/blog/2014/05/19/continuous-delivery-automating-deployment-visibility/" class="post-read-more">[Read More]</a></article><article class="post-preview"><a href="/blog/2014/05/15/managing-windows-features-with-puppet/"><h2 class="post-title">Managing Windows Features with Puppet</h2></a><p class="post-meta">Posted on 15 May 2014 · <a href="/blog/categories/Puppet/" class="tag post-meta">Puppet</a> · <a href="/blog/categories/PowerShell/" class="tag post-meta">PowerShell</a> · <a href="/blog/categories/DevOps/" class="tag post-meta">DevOps</a> · <a href="/blog/categories/Configuration-Management/" class="tag post-meta">Configuration Management</a> · <a href="/blog/categories/Windows/" class="tag post-meta">Windows</a> · <a href="/blog/categories/WindowsFeature/" class="tag post-meta">WindowsFeature</a></p><div class="post-entry"><p>Back in June 2013, I wrote about <a href="/blog/2013/06/14/windows-feature-management-with-powershell/">Windows Feature Management with PowerShell</a>. We have since released a Puppet module that will do this for us. We originally wrote PowerShell:</p>
<pre><code>Import-Module ServerManager
Add-WindowsFeature Web-Asp-Net
</code></pre><p>The Puppet module now wraps this code as follows:</p>
<pre><code>windowsfeature { &apos;Web-Asp-Net&apos;: }
</code></pre><p>The declaration windowsfeature is a specific Puppet type called a <a href="http://docs.puppetlabs.com/learning/definedtypes.html" target="_blank" rel="external">define</a>. In developer terms, this is the equivalent of a helper method that can be reused. We can also make sure that Windows Features are <em>not</em> installed on the server as follows:</p>
<pre><code>windowsfeature { &apos;Telnet-Server&apos;: 
  ensure =&gt; absent 
}
</code></pre><p>In the backing code for the module, we do a check before we install / uninstall any windows features. This means that we will only make the changes we really need to. This ensures idempotency of the script. By using this class, we can build up a list of what features a server should have enabled / installed on it. As example manifest would look as follows:</p>
<pre><code>class my_windows_features {
  windowsfeature { &apos;Web-Asp-Net&apos;: }
  windowsfeature { &apos;Web-Net-Ext&apos;: }
  windowsfeature { &apos;Web-ISAPI-Ext&apos;: }
  windowsfeature { &apos;Web-ISAPI-Filter&apos;: }
  windowsfeature { &apos;Web-Mgmt-Tools&apos;: }
  windowsfeature { &apos;Web-Mgmt-Console&apos;: }
  windowsfeature { &apos;Telnet-Server&apos;: ensure =&gt; absent }
}
</code></pre><p>The server will have it’s shipping list of Windows Features checked every 30 minutes by Puppet. We are sure that any changes encountered during that time will be applied as expected.  You can find more about our WindowsFeature module on the <a href="http://github.com/opentable/puppet-windowsfeature" target="_blank" rel="external">github repo</a>. If you want to use the module, then you can install it using the Puppet Module tool via the <a href="http://forge.puppetlabs.com/opentable/windowsfeature" target="_blank" rel="external">Puppet Forge</a></p>
</div><a href="/blog/2014/05/15/managing-windows-features-with-puppet/" class="post-read-more">[Read More]</a></article><article class="post-preview"><a href="/blog/2014/05/13/managing-windows-web-applications-with-puppet/"><h2 class="post-title">Managing Windows Web Applications with Puppet</h2></a><p class="post-meta">Posted on 13 May 2014 · <a href="/blog/categories/Puppet/" class="tag post-meta">Puppet</a> · <a href="/blog/categories/PowerShell/" class="tag post-meta">PowerShell</a> · <a href="/blog/categories/DevOps/" class="tag post-meta">DevOps</a> · <a href="/blog/categories/Configuration-Management/" class="tag post-meta">Configuration Management</a> · <a href="/blog/categories/Windows/" class="tag post-meta">Windows</a> · <a href="/blog/categories/IIS/" class="tag post-meta">IIS</a></p><div class="post-entry"><p>As part of our move towards a configuration management tool, we really wanted to start automating as much of our infrastructure as possible. This included our application configuration stack. IIS management is pretty easy with PowerShell. It would look something like this</p>
<pre><code>Import-Module WebAdministration
New-WebSite -Name &quot;DemoSite&quot; -Port 80 -IP * -PhysicalPath &quot;c:\inetpub\wwwroot&quot; -ApplicationPool &quot;MyAppPool&quot;
</code></pre><p>This would of course set up a website called ‘DemoSite’ running on port 80 on the local machine. The cmdlets that come with PowerShell make this pretty easy. This is great if it is a one-off job to set up a site. We run our websites from a number of webservers, therefore, it would be silly to have to RDP into each webserver and run a script on it. This is why tools like Puppet, Chef, Ansible etc. exist. We needed a configuration management tool to do this work for us. It has a number of benefits:</p>
<ul>
<li>Orchestration</li>
<li>Idempotency</li>
<li>Makes sure that each server is configured in ‘exactly’ the same way as no human intervention is needed</li>
<li>Developers can help the operations team by creating the scripts needed. This is great for collaboration between teams</li>
</ul>
<p>On investigating how we would do this with Puppet, we noticed that there were not many other people managing their site in this way. Therefore, we would have to turn our PowerShell scripts into Puppet modules to manage our system. </p>
<p>We have since created a Puppet module to manage IIS. To manage IIS with Puppet, we can now write the following code:</p>
<pre><code>iis::manage_site { &apos;DemoSite:
   site_path     =&gt; &apos;c:\inetpub\wwwroot&apos;,
   port          =&gt; &apos;80&apos;,
   ip_address    =&gt; &apos;*&apos;,
   app_pool      =&gt; &apos;MyAppPool&apos;
}
</code></pre><p>This would produce <strong>exactly</strong> the same results as the code from above. But it has 1 difference. There are checks in the code behind this module that will mean the code will only execute when it is needed, i.e. when the site_path isn’t correct or the app_pool isn’t correct. This is idempotency. The script can be run again and again and again….</p>
<p>To create an application binding, we used to do this in PowerShell:</p>
<pre><code>Import-Module WebAdministration
New-WebBinding -Name &apos;DemoSite&apos; -Port &apos;8080&apos; -IPAddress &apos;*&apos;
</code></pre></div><a href="/blog/2014/05/13/managing-windows-web-applications-with-puppet/" class="post-read-more">[Read More]</a></article><article class="post-preview"><a href="/blog/2014/04/29/remote-worker-notes-tools-and-setup/"><h2 class="post-title">Remote Worker Notes &ndash; Tools and Setup</h2></a><p class="post-meta">Posted on 29 April 2014 · <a href="/blog/categories/Work-smarter/" class="tag post-meta">Work smarter</a> · <a href="/blog/categories/Culture/" class="tag post-meta">Culture</a> · <a href="/blog/categories/Agile/" class="tag post-meta">Agile</a> · <a href="/blog/categories/Remote-working/" class="tag post-meta">Remote working</a></p><div class="post-entry"><p>For the last couple months I’ve been working remotely with our search team at OpenTable. Let me share our remote working setup and some rationale for our choices. I will shy away from judging how it’s all worked out and leave that for subsequent blog posts.</p>
<h2 id="The-deal"><a href="#The-deal" class="headerlink" title="The deal"></a>The deal</h2><p>I started as an on-site engineer and subsequently became a remote worker and my challenge was to make remote working as similar to on-site working as possible. Thus it is natural that <strong>I work the same working hours</strong> as my colleagues in the office (despite the time difference) and I take <strong>public holidays</strong> at the same time that there are bank holidays in UK (even though in Poland they are different).</p>
<p>We also decided that every two months I will <strong>visit the office for a week</strong> as well as arranging visits to coincide with other office guests (like contractors, overseas colleagues and so on). All this is to try to keep me as close to the team as possible and disrupt the normal work-flow as little as possible.</p>
<h2 id="The-workplace-setup"><a href="#The-workplace-setup" class="headerlink" title="The workplace setup"></a>The workplace setup</h2><p>Once home in Poland I had to carefully consider my options for a workplace. I tried three obvious possibilities:</p>
<ul>
<li>Dining room in my own one bedroom flat</li>
<li>Co-working space</li>
<li>Private room in my parents’ house</li>
</ul>
<p>The <strong>dining room</strong> worked pretty well, for a time…  I would ‘arrive’ really early in the office (just after taking a shower), and then be ‘home’ straight after the laptop lid was closed. My wife kindly respected that I am focused at work and distracted me only to share lunch (or to kick me out of house to bring the lunch in).</p>
<p>A couple of things made it only a short-term solution - the first being my back complaining about working on a chair that’s nice for a dinner, but awful for working on computer. Then I realised that I really miss a second monitor and separate keyboard &ndash; I guess anybody who coded in the middle of summer on a laptop knows the pain of a hot computer under your fingers.  Finally, my child was born, and that was it &ndash; a crying child in the same room when you are trying to pair with somebody is a deal-breaker.</p>
<p>In the meantime I evaluated a local <strong>co-working space</strong>. The problem was that it was quiet, <em>really quiet</em>, up to the point that I was embarrassed to pair with somebody remotely. The way we work fluctuates over time; there are weeks when I do stuff alone and in silence, there are weeks when I spend whole days on conversations or pairing. I just cannot be too quiet. For that matter I tried also a coffee shop, but it failed me for exactly the same reasons as the dining room table.</p></div><a href="/blog/2014/04/29/remote-worker-notes-tools-and-setup/" class="post-read-more">[Read More]</a></article><article class="post-preview"><a href="/blog/2014/04/28/effective-prioritisation/"><h2 class="post-title">Effective prioritisation</h2></a><p class="post-meta">Posted on 28 April 2014 · <a href="/blog/categories/Leadership/" class="tag post-meta">Leadership</a> · <a href="/blog/categories/Coaching/" class="tag post-meta">Coaching</a> · <a href="/blog/categories/Work-smarter/" class="tag post-meta">Work smarter</a> · <a href="/blog/categories/Culture/" class="tag post-meta">Culture</a></p><div class="post-entry"><p>Prioritisation is a huge part of modern life.</p>
<p>No.</p>
<p>Prioritisation is an ESSENTIAL part of modern life.</p>
<p>I’m not talking solely about Agile here either. Yes we plan stories, yes we prioritise them to get them into the backlog but I’m aiming at a higher level. Life lessons that are useful to all of us.</p>
<p>How do we know what to do next? Perhaps you lean on your gut feeling to order your to-do list. Maybe it is real-time cost and budget implications that influence your priorities or does it come down to who shouts loudest?</p>
<h2 id="Why-is-prioritisation-important"><a href="#Why-is-prioritisation-important" class="headerlink" title="Why is prioritisation important?"></a>Why is prioritisation important?</h2><p>The experts would have us believe we are living through the Digital Age, also know as the Computer Age. Increasingly this has been more accurately redefined as the Information Age. </p>
<p>The society we live in today truly bombardes us with information. Whether it be TV, mobile, emails, blog posts, status updates, tweets, likes and check-in’s we are rarely unconnected to modern day life and have a vast amount of data and information at our disposal.</p>
<p>This flood of information leads to a problem: we often confuse the importance of everyday tasks and activities. </p>
<p>For instance how many times have we said “I don’t have time to read” or “I’d love to be able to go to the gym more”. Perhaps a more honest way to say this is “reading is not a high priority for me” or “I prioritise other activities higher than going to the gym”. </p></div><a href="/blog/2014/04/28/effective-prioritisation/" class="post-read-more">[Read More]</a></article></div><ul class="pager main-pager"><li class="previous"><a href="/page/2">← Newer Posts</a></li><li class="next"><a href="/page/4">Older Posts →</a></li></ul></div></div></div><footer><div class="container beautiful-jekyll-footer"><div class="row"><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><ul class="list-inline text-center footer-links"><li><a href="https://github.com/opentable" title="GitHub"><span class="fa-stack fa-lg"><i class="fa fa-circle fa-stack-2x"></i><i class="fa fa-stack-1x fa-inverse fa-github"></i></span></a></li><li><a href="https://twitter.com/opentabletechuk" title="Twitter"><span class="fa-stack fa-lg"><i class="fa fa-circle fa-stack-2x"></i><i class="fa fa-stack-1x fa-inverse fa-twitter"></i></span></a></li><li><a href="https://www.linkedin.com/company/12181" title="LinkedIn"><span class="fa-stack fa-lg"><i class="fa fa-circle fa-stack-2x"></i><i class="fa fa-stack-1x fa-inverse fa-linkedin"></i></span></a></li><li><a href="http://stackoverflow.com/jobs/companies/opentable" title="StackOverflow"><span class="fa-stack fa-lg"><i class="fa fa-circle fa-stack-2x"></i><i class="fa fa-stack-1x fa-inverse fa-stack-overflow"></i></span></a></li></ul><p class="copyright text-muted">© OpenTable • 2016 • <a href="mailto:undefined"></a>
</p><p class="theme-by text-muted">Theme by
<a href="https://github.com/twoyao/beautiful-hexo">beautiful-hexo</a></p></div></div></div></footer><script src="/js/jquery-1.11.2.min.js"></script><script src="/js/bootstrap.min.js"></script><script src="/js/main.js"></script><script src="/js/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script>(function (i, s, o, g, r, a, m) {
    i['GoogleAnalyticsObject'] = r;
    i[r] = i[r] || function () {
                (i[r].q = i[r].q || []).push(arguments)
            }, i[r].l = 1 * new Date();
    a = s.createElement(o),
            m = s.getElementsByTagName(o)[0];
    a.async = 1;
    a.src = g;
    m.parentNode.insertBefore(a, m)
})(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');
ga('create', 'UA-2621903-16', 'auto');
ga('send', 'pageview');</script></body></html>